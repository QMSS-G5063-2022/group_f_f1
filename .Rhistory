geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Ages") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.5, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 33)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.5, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place,Age 37)", color = "#000000", size = 3
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Ages") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 33)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place,Age 37)", color = "#000000", size = 3
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Ages") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 33)", color = "#000000", size = 4
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place,Age 37)", color = "#000000", size = 4
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Ages") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 33)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place,Age 37)", color = "#000000", size = 3
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Ages") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 24)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place, Age 37)", color = "#000000", size = 3
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Ages") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 24)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place, Age 37)", color = "#000000", size = 3, font = "bold"
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle(NULL) +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 24)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place, Age 37)", color = "#000000", size = 3
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Age Distribution - 2021 Drivers") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 24)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place, Age 37)", color = "#000000", size = 3
)
age_distrib_df <- races2021 %>%
select(driverId)
age_distrib_df <- age_distrib_df %>%
left_join(drivers_df, by = "driverId") %>%
mutate(age = floor(
as.numeric(difftime("2021-12-31", birth_date, units = "weeks")) / 52.0)
) %>%
select(driverId, age, firstname, lastname) %>%
distinct() %>%
arrange(age)
#View(age_distrib_df)
age_distrib_df <- age_distrib_df %>%
mutate(bins = cut(age, breaks = c(20, 22, 25, 28, 30, 33, 36, 39, 42))) %>%
group_by(bins) %>%
summarize(count = n()) %>%
ungroup() %>%
mutate(perc = count / sum(count))
#View(age_distrib_df)
ggplot(data = age_distrib_df) +
geom_bar(
mapping = aes(x = bins, y = perc),
fill = "#534B4F", # "#56483F",
stat = "identity",
#width = 1,
show.legend = FALSE
) +
geom_text(
mapping = aes(x = bins, y = perc, label = count),
color = "#FFFFFF",
vjust = 1.5,
show.legend = FALSE
) +
scale_y_continuous(labels = scales::percent) +
ggtitle("Age Distribution - 2021 Active Drivers") +
xlab("Ages") +
ylab("Drivers (%)") +
theme_bw(16) +
theme(
plot.title=element_text(hjust=0.5, size = 12),
axis.title=element_text(size = 11),
axis.text.x=element_text(angle = 90, vjust = 0.5, size = 10),
axis.text.y=element_text(size = 10)
) +
geom_segment(
aes(xend = "(22,25]", yend = 0.20, x = "(25,28]", y = 0.25),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.26,
label="Max Verstappen (1st place, Age 24)", color = "#000000", size = 3
) +
geom_segment(
aes(xend = "(36,39]", yend = 0.05, x = "(30,33]", y = 0.18),
arrow = arrow(length = unit(0.2, "cm"))
) +
annotate("text",
x = "(30,33]", y = 0.20,
label="Lewis Hamilton (2nd place, Age 37)", color = "#000000", size = 3
)
